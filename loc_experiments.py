from LocReg_model import LocationRegressionModelV1 as model1
from experiment_utils import train_loc_model

data_root = "./Recreating Dataset/locationing_dataset/"
train_data_dir = data_root+"train/"
test_data_dir = data_root+"test/"


expt1 = {
    'model': model1(),
    'nametag': "original_test",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'learning_rate': 1e-4, 
    'reg_constant': 0,
    'epochs': 300, 
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_10 = {
    'model': model1(),
    'nametag': "test_scaling_and_centroid",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'learning_rate': 1e-4, 
    'reg_constant': 30,
    'epochs': 10, 
    'MSE_centroid_coeff': 10, 
    'MSE_label_coeff': 20,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug = {
    'model': model1(),
    'nametag': "debug_scaling_and_centroid",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'scaling': "sigmoid",
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 1, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 1,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_trash = {
    'model': model1(),
    'nametag': "debug_trash",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-min--no-scaling",
    # 'scaling': None,
    'loss_version':1, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 1, 
    'testing_sample_size': 3,
    'MSE_centroid_coeff': 1, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 1,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_MSELabel1_reg1 = {
    'model': model1(),
    'nametag': "debug_sigmoid_and_MSElabel1_reg1",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'scaling': "sigmoid",
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 0, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 0,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_MSELabel10_reg1 = {
    'model': model1(),
    'nametag': "debug_sig_and_MSElabel10_reg1",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'scaling': "sigmoid",
    'learning_rate': 1e-4, 
    'reg_constant': 0,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 0, 
    'MSE_label_coeff': 10,
    'MSE_poolpt_coeff': 0,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}


expt2_300 = {
    'model': model1(),
    'nametag': "test_scaling_and_centroid",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'learning_rate': 1e-4, 
    'reg_constant': 30,
    'epochs': 300, 
    'MSE_centroid_coeff': 10, 
    'MSE_label_coeff': 20,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}


### debug_and_search
expt2_debug_search_1_1_1 = {
    'model': model1(),
    'nametag': "debug_search__min_zero--unit-linear__1_1_1",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-min--unit-linear",
    # 'scaling': None,
    'loss_version':1, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 1, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 1,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_search_1_0_0 = {
    'model': model1(),
    'nametag': "debug_search__min_zero--unit-linear__1_0_0",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-min--unit-linear",
    # 'scaling': None,
    'loss_version':1, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 0, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 0,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_search_1_1_0 = {
    'model': model1(),
    'nametag': "debug_search__min_zero--unit-linear__1_1_0",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-min--unit-linear",
    # 'scaling': None,
    'loss_version':1, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 1, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 0,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_search_1_0_1 = {
    'model': model1(),
    'nametag': "debug_search__min_zero--unit-linear__1_0_1",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-min--unit-linear",
    # 'scaling': None,
    'loss_version':1, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 0, 
    'MSE_label_coeff': 1,
    'MSE_poolpt_coeff': 1,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_debug_search_10_1_1 = {
    'model': model1(),
    'nametag': "debug_search__min_zero--unit-linear__10_1_1",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-min--unit-linear",
    # 'scaling': None,
    'loss_version':1, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 1, 
    'MSE_label_coeff': 10,
    'MSE_poolpt_coeff': 1,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_test_offset_10_0_0_linear = {
    'model': model1(),
    'nametag': "testing_offset__pool_zero--unit-linear__10_0_0",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-pool--unit-linear",
    # 'scaling': None,
    'loss_version':2, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 0, 
    'MSE_label_coeff': 10,
    'MSE_poolpt_coeff': 0,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

expt2_test_offset_10_0_0_no_scaling = {
    'model': model1(),
    'nametag': "testing_offset__pool_zero--unit-linear__10_0_0",
    'train_data_dir': train_data_dir, 
    'test_data_dir': test_data_dir, 
    'log_root': "./_loc_log/",
    'model_root': "./_loc_model/", 
    'tensorboard_root': "./_loc_runs/" ,
    'batch_size': 1, 
    'output_scaling': None,
    'scaling': "zero-at-pool--no-scaling",
    # 'scaling': None,
    'loss_version':2, 
    'learning_rate': 1e-4, 
    'reg_constant': 1,
    'epochs': 10, 
    # 'testing_sample_size': 3,
    'MSE_centroid_coeff': 0, 
    'MSE_label_coeff': 10,
    'MSE_poolpt_coeff': 0,
    'draw_list': [0,2,23, 40, 10], 
    'cuda': True, 
    'model_params_path': None, 
    'debug': False,
    'draw_frequency':1, 
    'save_frequency':1,
}

# experiments = [expt2_10]
# experiments = [expt2_debug]
# experiments = [expt2_debug_trash]
# experiments = [expt2_debug_MSELabel1_reg1, expt2_debug_MSELabel10_reg1]
# experiments = [expt2_debug_search_1_1_1, expt2_debug_search_1_0_0, 
#                 expt2_debug_search_1_1_0, expt2_debug_search_1_0_1,
#                 expt2_debug_search_10_1_1, expt2_test_offset_10_0_0_no_scaling,
#                 expt2_test_offset_10_0_0_linear]

experiments = [expt2_debug_search_10_1_1, expt2_test_offset_10_0_0_no_scaling,
                expt2_test_offset_10_0_0_linear]


# experiments = [expt2_debug_search_10_1_1]

for expt in experiments:
    train_loc_model(**expt)